{{#app-view}}
    {{#block-slot 'breadcrumbs'}}
        <ol>
            <li><a href={{href-to 'dc.kv'}}>/</a></li>
{{#each (slice 0 -1 (split parent.Key '/')) as |breadcrumb index|}}
            <li><a href={{href-to 'dc.kv.folder' (join '/' (append (slice 0 (add index 1) (split parent.Key '/')) ''))}}>{{breadcrumb}}/</a></li>
{{/each}}
        </ol>
    {{/block-slot}}
    {{#block-slot 'header'}}
        <h1>
{{#if item.Key }}
            {{item.Key}}
{{ else }}
            {{parent.Key}}
{{/if}}
        </h1>
    {{/block-slot}}
    {{#block-slot 'content'}}
        <form>
            <fieldset>
{{#if create }}
                <label class="type-text">
                    <span>Key Name</span>
                    <input type="text" value={{replace item.Key parent.Key ''}} name="additional" onkeyup={{action 'change'}} placeholder="Key or folder" />
                    <em>To create a folder, end a key with <code>/</code></em>
                </label>
{{/if}}
{{#if (not-eq (last item.Key) '/') }}
                <div>
                    {{! temporary style attr until I can make a id/class adder }}
                    <label class="type-toggle">
                        <input type="checkbox" name="json" checked={{if json 'checked' }} onchange={{action 'change'}} />
                        <span>JSON</span>
                    </label>
                    <label class="type-text">
                        <span>Value</span>
    {{#if json}}
                        {{ code-editor value=(atob item.Value) onkeyup=(action 'change') disabled=item.isLocked }}
    {{else}}
                        <input type="text" name="value" value={{atob item.Value}} onkeyup={{action 'change'}} />
    {{/if}}
                    </label>
                </div>
{{/if}}
            </fieldset>
            {{!if (or model.isLocked model.isLoading)}}
{{#if create }}
            <button type="submit" {{ action "create" item parent}}>Save</button>
{{ else }}
            <button type="submit" {{ action "update" item parent}}>Save</button>
            <button type="reset" {{ action "cancel" item parent}}>Cancel changes</button>

            {{!if (or item.isLocked isLoading)}}
            {{#confirmation-dialog message='Are you sure you want to delete this key?'}}
                {{#block-slot 'action' as |confirm|}}
                    <button type="button" class="type-delete" {{action confirm 'delete' item parent}}>Delete</button>
                {{/block-slot}}
                {{#block-slot 'dialog'}}
                    <p>
                        Are you sure you want to delete {{item.basename}}?
                    </p>
                    <button type="button" class="type-cancel" {{action cancel}}>Cancel</button>
                {{/block-slot}}
            {{/confirmation-dialog}}
{{/if}}
        </form>

        {{#if key.isLocked}}
            <div>
                <h2>Lock Session</h2>
                <dl>
                    <dt>Name</dt>
                    <dd>{{session.Name}}</dd>
                    <dt>ID</dt>
                    <dd>{{session.ID}}</dd>
                    <dt>Behavior</dt>
                    <dd><{{session.Behavior}}/dd>
                    <dt>Delay</dt>
                    <dd><{{session.Delay}}/dd>
                    <dt>TTL</dt>
                    <dd>{{session.TTL}}</dd>
                    <dt>Health Checks</dt>
                    <dd>Checks in here</dd>
                </dl>
            {{#confirmation-dialog message='Are you sure you want to invalidate this session?'}}
                {{#block-slot 'action' as |confirm|}}
                    <button type="button" class="type-delete" {{ action confirm "invalidateSession" session }}>Invalidate Session</button>
                {{/block-slot}}
                {{#block-slot 'dialog'}}
                    <p>
                        Are you sure you want to invalidate this session?
                    </p>
                    <button type="button" class="type-cancel" {{ action cancel}}>Cancel</button>
                {{/block-slot}}
            {{/confirmation-dialog}}
            </div>
        {{/if}}
    {{/block-slot}}
{{/app-view}}